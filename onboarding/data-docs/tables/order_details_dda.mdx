---
title: 'Table: Order Details'
description: 'Working with the `obt_orders` table in BigQuery'
icon: 'bag-shopping'
---

The **Order Details** table (`obt_orders`) is your primary table for order-level analysis. It contains one row per order with all relevant order attributes, customer information, and attribution data pre-joined.

## When to Use This Table

<CardGroup cols={2}>
  <Card title="Order Analysis" icon="magnifying-glass-chart">
    Analyze individual orders, AOV, discount usage
  </Card>
  <Card title="Attribution Analysis" icon="bullseye">
    Understand which channels drive orders
  </Card>
  <Card title="Customer Segmentation" icon="users">
    Segment orders by new vs returning customers
  </Card>
  <Card title="Cohort Analysis" icon="layer-group">
    Build acquisition cohorts and track LTV
  </Card>
</CardGroup>

## Key Columns

| Column | Description |
|--------|-------------|
| `sm_order_key` | Unique order identifier (use for joins) |
| `order_processed_at_local_datetime` | Order timestamp in your brand's timezone |
| `is_order_sm_valid` | Filter to `TRUE` to exclude test/cancelled orders |
| `net_order_revenue` | Revenue after refunds |
| `sm_channel` | Primary channel classification |
| `sm_valid_order_index` | Customer's order number (1 = first order) |
| `sm_customer_key` | Unique customer identifier |

## Critical Filter

<Warning>
Always filter to valid orders in your queries:
```sql
WHERE is_order_sm_valid = TRUE
```
This excludes test orders, cancelled orders, and other invalid transactions.
</Warning>

## Example Queries

### Orders by Channel
```sql
SELECT
  sm_channel,
  COUNT(*) AS order_count,
  SUM(net_order_revenue) AS total_revenue,
  AVG(net_order_revenue) AS avg_order_value
FROM `your_project.sm_transformed_v2.obt_orders`
WHERE is_order_sm_valid = TRUE
  AND order_processed_at_local_datetime >= '2026-01-01'
GROUP BY sm_channel
ORDER BY total_revenue DESC
```

### New vs Returning Customer Orders
```sql
SELECT
  CASE WHEN sm_valid_order_index = 1 THEN 'New' ELSE 'Returning' END AS customer_type,
  COUNT(*) AS order_count,
  SUM(net_order_revenue) AS total_revenue
FROM `your_project.sm_transformed_v2.obt_orders`
WHERE is_order_sm_valid = TRUE
  AND order_processed_at_local_datetime >= DATE_SUB(CURRENT_DATE(), INTERVAL 30 DAY)
GROUP BY customer_type
```

### Orders with Specific Discount Code
```sql
SELECT
  order_id,
  order_processed_at_local_datetime,
  net_order_revenue,
  order_discount_codes_csv
FROM `your_project.sm_transformed_v2.obt_orders`
WHERE is_order_sm_valid = TRUE
  AND order_discount_codes_csv LIKE '%SUMMER%'
ORDER BY order_processed_at_local_datetime DESC
LIMIT 100
```

## Related Resources

<CardGroup cols={2}>
  <Card title="Full Table Schema" icon="table" href="/data-activation/data-tables/sm_transformed_v2/obt_orders">
    Complete column documentation
  </Card>
  <Card title="Order Lines Table" icon="list" href="/data-activation/data-tables/sm_transformed_v2/obt_order_lines">
    For product-level analysis
  </Card>
  <Card title="Dimension Definitions" icon="filter" href="/onboarding/data-docs/dimensions">
    Understanding dimension columns
  </Card>
</CardGroup>
