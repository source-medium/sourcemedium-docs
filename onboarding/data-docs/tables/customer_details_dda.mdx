---
title: 'Table: Customer Details'
description: 'Working with the `obt_customers` table in BigQuery'
icon: 'user'
---

The **Customer Details** table (`obt_customers`) provides customer-level data including contact information, subscription status, and first/last order references. Use this table for customer lookups and subscription analysis.

<Note>
**For lifetime metrics (LTV, order counts, acquisition channel):** Join to `obt_orders` and aggregate, or use `dim_customers` which includes pre-calculated lifetime fields.
</Note>

## When to Use This Table

<CardGroup cols={2}>
  <Card title="Customer Lookups" icon="user-magnifying-glass">
    Find customer details by ID or email
  </Card>
  <Card title="Subscription Analysis" icon="rotate">
    Analyze subscriber status and churn
  </Card>
  <Card title="Contact Data" icon="address-book">
    Access customer contact information
  </Card>
  <Card title="Order References" icon="link">
    Link to first and last orders
  </Card>
</CardGroup>

## Key Columns

| Column | Description |
|--------|-------------|
| `sm_customer_key` | Unique customer identifier (use for joins) |
| `customer_email_hashed` | SHA-256 hash of email for privacy-safe matching |
| `customer_email` | Customer email address (PII) |
| `customer_created_at` | When the customer record was created |
| `customer_first_order_id` | ID of customer's first order |
| `customer_last_order_id` | ID of customer's most recent order |
| `subscriber_status` | Current subscription status |
| `customer_tags_csv` | Customer tags from your platform |

## Example Queries

### Customer Lookup by Email Hash
```sql
SELECT
  sm_customer_key,
  customer_email_hashed,
  customer_created_at,
  subscriber_status
FROM `your_project.sm_transformed_v2.obt_customers`
WHERE customer_email_hashed = 'your_sha256_hash_here'
```

### Subscribers by Status
```sql
SELECT
  subscriber_status,
  COUNT(*) AS customer_count
FROM `your_project.sm_transformed_v2.obt_customers`
WHERE subscriber_status IS NOT NULL
GROUP BY subscriber_status
ORDER BY customer_count DESC
```

### Customer Lifetime Metrics (via Join)
To get lifetime value and order counts, join to `obt_orders`:

```sql
SELECT
  c.sm_customer_key,
  c.customer_email_hashed,
  c.customer_created_at,
  COUNT(o.sm_order_key) AS lifetime_order_count,
  SUM(o.order_net_revenue) AS lifetime_revenue,
  MIN(o.order_processed_at_local_datetime) AS first_order_date,
  MAX(o.order_processed_at_local_datetime) AS last_order_date
FROM `your_project.sm_transformed_v2.obt_customers` c
LEFT JOIN `your_project.sm_transformed_v2.obt_orders` o
  ON c.sm_customer_key = o.sm_customer_key
  AND o.is_order_sm_valid = TRUE
GROUP BY 1, 2, 3
ORDER BY lifetime_revenue DESC
LIMIT 100
```

### Recently Created Customers
```sql
SELECT
  sm_customer_key,
  customer_email_hashed,
  customer_created_at,
  subscriber_status
FROM `your_project.sm_transformed_v2.obt_customers`
WHERE customer_created_at >= DATE_SUB(CURRENT_DATE(), INTERVAL 30 DAY)
ORDER BY customer_created_at DESC
LIMIT 100
```

## Related Resources

<CardGroup cols={2}>
  <Card title="Full Table Schema" icon="table" href="/data-activation/data-tables/sm_transformed_v2/obt_customers">
    Complete column documentation
  </Card>
  <Card title="Order Details Table" icon="bag-shopping" href="/onboarding/data-docs/tables/order_details_dda">
    For order-level analysis
  </Card>
  <Card title="Dimension Definitions" icon="filter" href="/onboarding/data-docs/dimensions">
    Understanding dimension columns
  </Card>
</CardGroup>
